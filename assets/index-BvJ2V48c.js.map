{"version":3,"file":"index-BvJ2V48c.js","sources":["../../src/logo.png","../../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__DacSPZ0B__\"","import './style.css'\nimport logoUrl from './logo.png'\n\n// Importar todos os JSONs de categorias\nimport analgesicosOpioides from './infos/json/Analgesicosopioides.json'\nimport antiHistaminico from './infos/json/anti-histaminico.json'\nimport antiInflamatorio from './infos/json/Anti-Inflamatorio.json'\nimport antiarritmicos from './infos/json/antiarritmicos.json'\nimport antibioticos from './infos/json/antibioticos.json'\nimport anticonvulsivantes from './infos/json/anticonvulsivantes.json'\nimport antiemeticos from './infos/json/antiemeticos.json'\nimport antifungicos from './infos/json/antifungicos.json'\nimport antiparasitarios from './infos/json/antiparasitarios_vermifugos.json'\nimport antiulcerosos from './infos/json/antiulcerosos.json'\nimport corticoesteroides from './infos/json/corticoesterioides.json'\nimport diureticos from './infos/json/diureticos.json'\nimport laxantesAntigases from './infos/json/laxantes_antigases.json'\nimport outros from './infos/json/outros.json'\nimport sistemaRespiratorio from './infos/json/sistema_respiratorio.json'\nimport vasodilatadores from './infos/json/vasodilatadores.json'\nimport vasopressores from './infos/json/vasopressores.json'\nimport vitaminas from './infos/json/vitaminas.json'\n\n// Mapeamento de categorias\nconst CATEGORIAS = {\n  'analgesicos-opioides': { nome: 'Analg√©sicos Opioides', dados: analgesicosOpioides },\n  'anti-histaminico': { nome: 'Anti-histam√≠nico', dados: antiHistaminico },\n  'anti-inflamatorio': { nome: 'Anti-inflamat√≥rio', dados: antiInflamatorio },\n  'antiarritmicos': { nome: 'Antiarr√≠tmicos', dados: antiarritmicos },\n  'antibioticos': { nome: 'Antibi√≥ticos', dados: antibioticos },\n  'anticonvulsivantes': { nome: 'Anticonvulsivantes', dados: anticonvulsivantes },\n  'antiemeticos': { nome: 'Antiem√©ticos', dados: antiemeticos },\n  'antifungicos': { nome: 'Antif√∫ngicos', dados: antifungicos },\n  'antiparasitarios': { nome: 'Antiparasit√°rios/Verm√≠fugos', dados: antiparasitarios },\n  'antiulcerosos': { nome: 'Antiulcerosos', dados: antiulcerosos },\n  'corticoesteroides': { nome: 'Corticoesteroides', dados: corticoesteroides },\n  'diureticos': { nome: 'Diur√©ticos', dados: diureticos },\n  'laxantes-antigases': { nome: 'Laxantes/Antigases', dados: laxantesAntigases },\n  'outros': { nome: 'Outros', dados: outros },\n  'sistema-respiratorio': { nome: 'Sistema Respirat√≥rio', dados: sistemaRespiratorio },\n  'vasodilatadores': { nome: 'Vasodilatadores', dados: vasodilatadores },\n  'vasopressores': { nome: 'Vasopressores', dados: vasopressores },\n  'vitaminas': { nome: 'Vitaminas', dados: vitaminas },\n}\n\nconst app = document.querySelector('#app')\n\n// Fun√ß√£o para verificar e aplicar tema salvo (padr√£o: claro)\nfunction aplicarTema() {\n  const temaSalvo = localStorage.getItem('tema')\n  const html = document.documentElement\n  \n  // Se n√£o tiver tema salvo ou for 'claro', garantir que est√° claro\n  if (!temaSalvo || temaSalvo === 'claro') {\n    html.classList.remove('dark')\n    localStorage.setItem('tema', 'claro')\n  } else if (temaSalvo === 'escuro') {\n    html.classList.add('dark')\n  }\n}\n\n// Aplicar tema imediatamente\naplicarTema()\n\n// Fun√ß√£o para alternar tema\nfunction alternarTema() {\n  const html = document.documentElement\n  const isDark = html.classList.contains('dark')\n  \n  if (isDark) {\n    html.classList.remove('dark')\n    localStorage.setItem('tema', 'claro')\n  } else {\n    html.classList.add('dark')\n    localStorage.setItem('tema', 'escuro')\n  }\n  \n  // Atualizar √≠cone ap√≥s mudan√ßa\n  atualizarIconeTema()\n}\n\n// Atualizar √≠cone do tema baseado no tema atual\nfunction atualizarIconeTema() {\n  const temaIcon = document.getElementById('temaIcon')\n  if (temaIcon) {\n    const isDark = document.documentElement.classList.contains('dark')\n    temaIcon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô'\n  }\n}\n\napp.innerHTML = `\n  <div id=\"splash\" class=\"fixed inset-0 z-50 flex items-center justify-center bg-pink-50 backdrop-blur-sm transition-opacity duration-700\">\n    <picture>\n      <img src=\"${logoUrl}\" alt=\"Logo\" class=\"block mx-auto w-auto h-auto max-w-[90vw] max-h-[75vh] object-contain\" />\n    </picture>\n  </div>\n  <header class=\"py-10\">\n    <div class=\"mx-auto max-w-2xl px-4 text-center\">\n      <img src=\"${logoUrl}\" alt=\"VetDose\" class=\"mx-auto h-16 w-auto\" />\n      <p class=\"mt-2 text-gray-600 dark:text-gray-300\">Calculadora de dosagem veterin√°ria</p>\n    </div>\n  </header>\n\n  <main class=\"mx-auto max-w-6xl px-4 pb-14\">\n    <div class=\"flex flex-col lg:flex-row gap-4 items-start\">\n      <section class=\"flex-1 rounded-xl bg-white dark:bg-gray-800/90 p-6 shadow-md dark:ring-gray-700 dark:ring-1\">\n        <div id=\"panel\"></div>\n      </section>\n      <div class=\"flex flex-row lg:flex-col gap-3 w-full lg:w-auto justify-center lg:justify-start\">\n        <button id=\"historicoBtn\" type=\"button\" aria-label=\"Ver hist√≥rico\" class=\"w-12 h-12 rounded-full bg-transparent transition-all cursor-pointer flex items-center justify-center\" title=\"Hist√≥rico de c√°lculos\">\n          <span class=\"text-xl text-gray-700 dark:text-gray-300\">üìã</span>\n        </button>\n        <button id=\"toggleTema\" type=\"button\" aria-label=\"Alternar tema\" class=\"w-12 h-12 rounded-full bg-transparent transition-all cursor-pointer flex items-center justify-center\">\n          <span id=\"temaIcon\" class=\"text-2xl text-gray-700 dark:text-gray-300\">üåô</span>\n        </button>\n      </div>\n    </div>\n  </main>\n`\n\n// Configurar event listener para toggle de tema ap√≥s renderizar HTML\n// Aguardar um pouco para garantir que o DOM est√° pronto\nsetTimeout(() => {\n  const toggleTema = document.getElementById('toggleTema')\n  if (toggleTema) {\n    // Remover qualquer listener anterior\n    const novoBtn = toggleTema.cloneNode(true)\n    toggleTema.parentNode.replaceChild(novoBtn, toggleTema)\n    \n    // Adicionar listener no novo bot√£o\n    const btn = document.getElementById('toggleTema')\n    btn.onclick = function(e) {\n      e.preventDefault()\n      e.stopPropagation()\n      alternarTema()\n    }\n    \n    atualizarIconeTema()\n  }\n  \n  // Bot√£o de hist√≥rico\n  const historicoBtn = document.getElementById('historicoBtn')\n  if (historicoBtn) {\n    historicoBtn.onclick = function(e) {\n      e.preventDefault()\n      mostrarHistorico()\n    }\n  }\n}, 200)\n\n// Fun√ß√£o para mostrar hist√≥rico\nfunction mostrarHistorico() {\n  const historico = getHistorico()\n  const panel = document.getElementById('panel')\n  \n  if (historico.length === 0) {\n    panel.innerHTML = `\n      <div class=\"mb-4\">\n        <h2 class=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Hist√≥rico de c√°lculos</h2>\n        <p class=\"mt-1 text-sm text-gray-600 dark:text-gray-400\">Nenhum c√°lculo salvo ainda.</p>\n        <button id=\"voltarHistorico\" class=\"mt-4 px-4 py-2 text-sm rounded-md bg-pink-500 dark:bg-pink-600 text-white hover:bg-pink-600 dark:hover:bg-pink-700 transition cursor-pointer\">‚Üê Voltar</button>\n      </div>\n    `\n    document.getElementById('voltarHistorico').onclick = () => renderForm()\n    return\n  }\n  \n  let html = `\n    <div class=\"mb-4 flex items-center justify-between\">\n      <h2 class=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Hist√≥rico de c√°lculos</h2>\n      <button id=\"limparHistorico\" class=\"px-3 py-1 text-xs rounded-md bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50 transition cursor-pointer\">Limpar hist√≥rico</button>\n    </div>\n    <div class=\"space-y-3\">\n  `\n  \n  historico.forEach((item, idx) => {\n    const data = new Date(item.timestamp)\n    const especieLabel = ESPECIES.find(e => e.value === item.especie)?.label || item.especie\n    html += `\n      <div class=\"rounded-lg bg-gray-50 dark:bg-gray-700 p-4 border border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition\" data-index=\"${idx}\">\n        <div class=\"flex items-start justify-between\">\n          <div class=\"flex-1\">\n            <div class=\"font-medium text-gray-900 dark:text-gray-100\">${item.med}</div>\n            <div class=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n              ${especieLabel} ‚Ä¢ ${formatNumber(item.peso)} kg ‚Ä¢ ${formatNumber(item.doseMg)} mg\n            </div>\n            ${item.notas ? `<div class=\"text-xs text-gray-500 dark:text-gray-400 mt-1 italic\">${item.notas}</div>` : ''}\n            <div class=\"text-xs text-gray-400 dark:text-gray-500 mt-2\">${data.toLocaleString('pt-BR')}</div>\n          </div>\n        </div>\n      </div>\n    `\n  })\n  \n  html += `\n    </div>\n    <button id=\"voltarHistorico\" class=\"mt-4 px-4 py-2 text-sm rounded-md bg-pink-500 dark:bg-pink-600 text-white hover:bg-pink-600 dark:hover:bg-pink-700 transition cursor-pointer\">‚Üê Voltar</button>\n  `\n  \n  panel.innerHTML = html\n  \n  // Event listeners\n  document.getElementById('voltarHistorico').onclick = () => renderForm()\n  document.getElementById('limparHistorico').onclick = () => {\n    if (confirm('Tem certeza que deseja limpar todo o hist√≥rico?')) {\n      limparHistorico()\n      mostrarHistorico()\n    }\n  }\n  \n  // Clicar em um item do hist√≥rico para reutilizar\n  panel.querySelectorAll('[data-index]').forEach(el => {\n    el.onclick = () => {\n      const idx = parseInt(el.dataset.index)\n      const item = historico[idx]\n      renderForm({\n        especie: item.especie,\n        categoria: item.categoria,\n        med: item.med.toLowerCase().replace(/[^a-z0-9]+/g, '-'),\n        pesoStr: formatNumber(item.peso),\n        concStr: item.concentracao ? formatNumber(item.concentracao) : '',\n        notas: item.notas || ''\n      })\n    }\n  })\n}\n\n// Splash: aparece por 2 segundos e depois faz fade-out\nconst splashEl = document.getElementById('splash')\nsetTimeout(() => {\n  splashEl.classList.add('opacity-0')\n  setTimeout(() => {\n    splashEl.remove()\n  }, 700) // Aguarda o fade-out completar antes de remover\n}, 2000) // 2 segundos na tela\n\n// Tabelas de dosagem por esp√©cie (mg/kg) e metadados\n// Quando existe faixa, usamos o ponto m√©dio para o c√°lculo e exibimos a faixa.\nconst DOSAGENS = {\n  amoxicilina: {\n    cachorro: { min: 10, max: 20, freq: 'a cada 12h', dur: '5‚Äì7 dias', obs: 'Uso oral comum.' },\n    gato:     { min: 10, max: 20, freq: 'a cada 12h', dur: '5‚Äì7 dias', obs: 'Uso oral comum.' },\n  },\n  doxiciclina: {\n    cachorro: { min: 5, max: 10, freq: 'a cada 12h', dur: '7‚Äì10 dias', obs: 'Pode causar fotossensibilidade.' },\n    gato:     { min: 5, max: 10, freq: 'a cada 12h', dur: '7‚Äì10 dias', obs: 'Administrar com √°gua.' },\n  },\n  enrofloxacina: {\n    cachorro: { min: 5, max: 10, freq: 'a cada 24h', dur: '5‚Äì10 dias', obs: 'Evitar em animais jovens.' },\n  },\n  dipirona: {\n    cachorro: { min: 25, max: 25, freq: 'a cada 8h', dur: 'conforme necessidade', obs: 'Uso conforme orienta√ß√£o.' },\n    gato:     { min: 12, max: 12, freq: 'a cada 8h', dur: 'conforme necessidade', obs: 'Uso conforme orienta√ß√£o.' },\n  },\n  ivermectina: {\n    cachorro: { min: 0.2, max: 0.4, freq: 'dose √∫nica', dur: '‚Äî', obs: 'Aten√ß√£o ra√ßas sens√≠veis (MDR1).'},\n    gato:     { min: 0.2, max: 0.2, freq: 'dose √∫nica', dur: '‚Äî', obs: 'Aten√ß√£o a rea√ß√µes adversas.' },\n  },\n  cefalexina: {\n    cachorro: { min: 15, max: 30, freq: 'a cada 12h', dur: '7‚Äì14 dias', obs: 'Uso oral.' },\n    gato:     { min: 15, max: 30, freq: 'a cada 12h', dur: '7‚Äì14 dias', obs: 'Uso oral.' },\n  },\n  meloxicam: {\n    cachorro: { min: 0.2, max: 0.2, freq: '0,2 mg/kg inicial, 0,1 mg/kg manuten√ß√£o 1x/dia', dur: 'conforme orienta√ß√£o', obs: 'Anti-inflamat√≥rio n√£o esteroidal.' },\n  },\n  prednisona: {\n    cachorro: { min: 0.5, max: 2.0, freq: 'a cada 24h', dur: 'conforme indica√ß√£o', obs: 'Ajuste conforme quadro cl√≠nico.' },\n  },\n  furosemida: {\n    cachorro: { min: 2, max: 6, freq: 'a cada 8‚Äì12h', dur: 'conforme resposta', obs: 'Diur√©tico ‚Äî monitorar hidrata√ß√£o.' },\n  },\n}\n\nconst limitesPesoKg = { min: 0.1, max: 500 }\n\nconst ESPECIES = [\n  { value: 'cachorro', label: 'üê∂ Cachorro' },\n  { value: 'gato',     label: 'üê± Gato' },\n  { value: 'coelho',   label: 'üê∞ Coelho' },\n  { value: 'cavalo',   label: 'üê¥ Cavalo' },\n  { value: 'ave',      label: 'üïäÔ∏è Ave' },\n  { value: 'boi',      label: 'üêÆ Boi' },\n  { value: 'porco',    label: 'üê∑ Porco' },\n]\n\n// Concentra√ß√µes padr√£o para medica√ß√µes l√≠quidas (mg/mL) - valores mais comuns no mercado\nconst CONCENTRACOES_PADRAO = {\n  // Antibi√≥ticos\n  'amoxicilina': [50, 100, 250], // Suspens√£o oral comum: 250mg/5mL = 50mg/mL\n  'ampicilina': [100, 250, 500], // Frasco reconstitu√≠do\n  'cefalexina': [50, 100, 250], // Suspens√£o\n  'cefalotina': [100, 200], // Frasco 1g em 5mL = 200mg/mL\n  'cefovecina': [80], // Convenia\n  'clindamicina': [25, 50, 75], // Suspens√£o\n  'doxiciclina': [10, 25, 50], // Suspens√£o\n  'enrofloxacina': [25, 50, 100], // Injet√°vel comum: 50mg/mL\n  'penicilina': [200, 400], // 600.000 UI ‚âà 360mg, 1.200.000 UI ‚âà 720mg\n  \n  // Analg√©sicos\n  'butorfanol': [10],\n  'fentanil': [0.05], // 50mcg/mL = 0.05mg/mL\n  'hidromorfona': [2],\n  'metadona': [10],\n  'morfina': [1, 10], // 1mg/mL ou 10mg/mL\n  'tramadol': [20, 50], // 2% = 20mg/mL\n  \n  // Anti-inflamat√≥rios\n  'meloxicam': [1.5, 2, 5], // Comum: 1.5mg/mL ou 5mg/mL\n  'carprofeno': [20, 50], // Comum: 50mg/mL\n  'cetoprofeno': [50, 100], // Comum: 100mg/mL\n  'dipirona': [250, 500], // Comum: 500mg/mL\n  \n  // Diur√©ticos\n  'furosemida': [10, 50], // Comum: 10mg/mL ou 50mg/mL\n  \n  // Outros comuns\n  'dexametasona': [2, 4], // Comum: 2mg/mL\n  'prednisolona': [5, 10, 20], // Suspens√£o oral\n  'prednisona': [5, 10, 20], // Comprimidos mais comuns, mas pode ter l√≠quido\n  'ivermectina': [1, 10], // Comum: 1% = 10mg/mL\n}\n\n// Utilit√°rios globais\nfunction round2(n) {\n  return Math.round((n + Number.EPSILON) * 100) / 100\n}\n\nfunction formatNumber(n) {\n  return n.toLocaleString('pt-BR', { maximumFractionDigits: 2, minimumFractionDigits: 0 })\n}\n\nfunction getRegra(medicamento, especie) {\n  const mapa = DOSAGENS[medicamento]\n  if (!mapa) return null\n  return mapa[especie] || mapa['cachorro'] || mapa['gato'] || null\n}\n\n// Fun√ß√£o para parsear dose dos JSONs (ex: \"C√£es e Gatos - 11 a 22mg/kg\" ou \"C√£es - 5 a 10mg/kg Gato - 0,5 a 2mg/kg\" ou \"2 - 4- 8mg/kg\" ou \"2 a 5mcg/kg\")\nfunction parseDoseFromJSON(doseStr, especie) {\n  if (!doseStr) return null\n  \n  const especieMap = { \n    'cachorro': ['C√£es', 'C√£o', 'C√£o -', 'C√£es -'], \n    'gato': ['Gatos', 'Gato', 'Gato -', 'Gatos -'],\n    'coelho': ['Coelho', 'Coelhos'],\n    'cavalo': ['Cavalo', 'Cavalos'],\n    'ave': ['Ave', 'Aves'],\n    'boi': ['Boi', 'Bois'],\n    'porco': ['Porco', 'Porcos']\n  }\n  const especieTerms = especieMap[especie] || []\n  \n  // Fun√ß√£o auxiliar para converter unidades (mcg para mg: 1 mcg = 0.001 mg)\n  const converterUnidade = (valor, unidade) => {\n    if (unidade && unidade.toLowerCase().includes('mcg')) {\n      return valor * 0.001 // Converte mcg para mg\n    }\n    return valor\n  }\n  \n  // Primeiro, tentar encontrar dose espec√≠fica para a esp√©cie (ex: \"C√£es - 0,5 a 1mg/kg Gato - 0,5 a 2mg/kg\" ou \"C√£es - 2 a 5mcg/kg\")\n  if (especieTerms.length > 0) {\n    for (const term of especieTerms) {\n      const especieRegex = new RegExp(`${term.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\s*([^Gato|C√£o|Gatos|C√£es]*?)(?:Gato|C√£o|Gatos|C√£es|$)`, 'i')\n      const especieMatch = doseStr.match(especieRegex)\n      if (especieMatch && especieMatch[1]) {\n        const parteEspecie = especieMatch[1]\n        // Procurar faixa com mg/kg ou mcg/kg\n        const faixaRegex = /(\\d+(?:[.,]\\d+)?)\\s*(?:a|at√©|-)\\s*(\\d+(?:[.,]\\d+)?)\\s*(mcg|mg)\\/kg/i\n        const faixaMatch = parteEspecie.match(faixaRegex)\n        if (faixaMatch) {\n          const min = parseFloat(faixaMatch[1].replace(',', '.'))\n          const max = parseFloat(faixaMatch[2].replace(',', '.'))\n          const unidade = faixaMatch[3]\n          return { \n            min: converterUnidade(min, unidade), \n            max: converterUnidade(max, unidade) \n          }\n        }\n        // Tentar dose √∫nica com mg/kg ou mcg/kg\n        const singleRegex = /(\\d+(?:[.,]\\d+)?)\\s*(mcg|mg)\\/kg/i\n        const singleMatch = parteEspecie.match(singleRegex)\n        if (singleMatch) {\n          const val = parseFloat(singleMatch[1].replace(',', '.'))\n          const unidade = singleMatch[2]\n          const valorConvertido = converterUnidade(val, unidade)\n          return { min: valorConvertido, max: valorConvertido }\n        }\n      }\n    }\n  }\n  \n  // Se n√£o encontrou espec√≠fico, procurar padr√µes gerais com m√∫ltiplos valores (ex: \"2 - 4- 8mg/kg\" ou \"15 - 22 - 30mg/kg\")\n  const multiRegex = /(\\d+(?:[.,]\\d+)?)\\s*(?:-|a|at√©)\\s*(\\d+(?:[.,]\\d+)?)\\s*(?:-|a|at√©)?\\s*(\\d+(?:[.,]\\d+)?)?\\s*(mcg|mg)\\/kg/i\n  const multiMatch = doseStr.match(multiRegex)\n  \n  if (multiMatch) {\n    const values = []\n    const unidade = multiMatch[4] || 'mg'\n    if (multiMatch[1]) values.push(converterUnidade(parseFloat(multiMatch[1].replace(',', '.')), unidade))\n    if (multiMatch[2]) values.push(converterUnidade(parseFloat(multiMatch[2].replace(',', '.')), unidade))\n    if (multiMatch[3]) values.push(converterUnidade(parseFloat(multiMatch[3].replace(',', '.')), unidade))\n    \n    if (values.length > 0) {\n      const min = Math.min(...values)\n      const max = Math.max(...values)\n      return { min, max }\n    }\n  }\n  \n  // Procurar por padr√µes como \"11 a 22mg/kg\" ou \"5 a 10mg/kg\" ou \"2 a 5mcg/kg\"\n  const regex = /(\\d+(?:[.,]\\d+)?)\\s*(?:a|at√©|-)\\s*(\\d+(?:[.,]\\d+)?)\\s*(mcg|mg)\\/kg/i\n  const match = doseStr.match(regex)\n  \n  if (match) {\n    const min = parseFloat(match[1].replace(',', '.'))\n    const max = parseFloat(match[2].replace(',', '.'))\n    const unidade = match[3]\n    return { \n      min: converterUnidade(min, unidade), \n      max: converterUnidade(max, unidade) \n    }\n  }\n  \n  // Tentar dose √∫nica (ex: \"5mg/kg\" ou \"2mcg/kg\")\n  const singleRegex = /(\\d+(?:[.,]\\d+)?)\\s*(mcg|mg)\\/kg/i\n  const singleMatch = doseStr.match(singleRegex)\n  if (singleMatch) {\n    const val = parseFloat(singleMatch[1].replace(',', '.'))\n    const unidade = singleMatch[2]\n    const valorConvertido = converterUnidade(val, unidade)\n    return { min: valorConvertido, max: valorConvertido }\n  }\n  \n  return null\n}\n\n// Fun√ß√µes para gerenciar favoritos\nfunction getFavoritos() {\n  try {\n    return JSON.parse(localStorage.getItem('favoritos') || '[]')\n  } catch {\n    return []\n  }\n}\n\nfunction salvarFavorito(medicamento, categoria) {\n  const favoritos = getFavoritos()\n  const key = `${categoria}:${medicamento}`\n  if (!favoritos.includes(key)) {\n    favoritos.push(key)\n    localStorage.setItem('favoritos', JSON.stringify(favoritos))\n  }\n}\n\nfunction removerFavorito(medicamento, categoria) {\n  const favoritos = getFavoritos()\n  const key = `${categoria}:${medicamento}`\n  const index = favoritos.indexOf(key)\n  if (index > -1) {\n    favoritos.splice(index, 1)\n    localStorage.setItem('favoritos', JSON.stringify(favoritos))\n  }\n}\n\nfunction isFavorito(medicamento, categoria) {\n  const favoritos = getFavoritos()\n  return favoritos.includes(`${categoria}:${medicamento}`)\n}\n\n// Fun√ß√µes para gerenciar hist√≥rico\nfunction salvarHistorico(calculo) {\n  try {\n    const historico = JSON.parse(localStorage.getItem('historico') || '[]')\n    historico.unshift({\n      ...calculo,\n      timestamp: new Date().toISOString()\n    })\n    // Manter apenas os √∫ltimos 50 c√°lculos\n    const historicoLimitado = historico.slice(0, 50)\n    localStorage.setItem('historico', JSON.stringify(historicoLimitado))\n  } catch (e) {\n    console.error('Erro ao salvar hist√≥rico:', e)\n  }\n}\n\nfunction getHistorico() {\n  try {\n    return JSON.parse(localStorage.getItem('historico') || '[]')\n  } catch {\n    return []\n  }\n}\n\nfunction limparHistorico() {\n  localStorage.removeItem('historico')\n}\n\n// Fun√ß√£o para exportar PDF\nfunction exportarPDF(view) {\n  // Usar a API de impress√£o do navegador para gerar PDF\n  // Criar uma nova janela com o conte√∫do formatado\n  const especieLabel = ESPECIES.find(e => e.value === view.especie)?.label || view.especie\n  const temFaixa = view.doseMinKg !== view.doseMaxKg\n  \n  let html = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"UTF-8\">\n      <title>VetDose - ${view.med}</title>\n      <style>\n        body { font-family: Arial, sans-serif; padding: 20px; color: #000; }\n        h1 { color: #ec4899; margin-bottom: 10px; }\n        .info { margin: 10px 0; }\n        .dose-box { border: 2px solid #10b981; padding: 15px; margin: 15px 0; border-radius: 8px; background: #f0fdf4; }\n        .dose-value { font-size: 24px; font-weight: bold; color: #059669; }\n        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 15px 0; }\n        .item { padding: 8px; background: #f9fafb; border-radius: 4px; }\n        .label { font-size: 12px; color: #6b7280; }\n        .value { font-weight: bold; }\n        @media print { body { padding: 0; } }\n      </style>\n    </head>\n    <body>\n      <h1>VetDose - Calculadora de Dosagem Veterin√°ria</h1>\n      <div class=\"info\"><strong>Esp√©cie:</strong> ${especieLabel}</div>\n      <div class=\"info\"><strong>Medicamento:</strong> ${view.med}</div>\n      <div class=\"info\"><strong>Peso:</strong> ${formatNumber(view.peso)} kg</div>\n      <div class=\"info\"><strong>Dosagem de refer√™ncia:</strong> ${view.faixaStr}</div>\n      \n      <div class=\"dose-box\">\n        <div class=\"label\">Dose Calculada</div>\n        <div class=\"dose-value\">${view.doseMg} mg</div>\n        ${view.volumeMl ? `<div style=\"margin-top: 5px;\">${view.volumeMl} mL</div>` : ''}\n        ${view.comprimidos ? `<div style=\"margin-top: 5px;\">${view.comprimidos} comprimido(s)</div>` : ''}\n      </div>\n      \n      ${temFaixa ? `\n      <div style=\"margin: 15px 0;\">\n        <div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;\">\n          <div style=\"padding: 10px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px;\">\n            <div class=\"label\">M√≠nimo</div>\n            <div class=\"value\">${view.doseMinMg} mg</div>\n            ${view.volumeMinMl ? `<div style=\"font-size: 12px;\">${view.volumeMinMl} mL</div>` : ''}\n          </div>\n          <div style=\"padding: 10px; background: #f0fdf4; border: 2px solid #10b981; border-radius: 4px;\">\n            <div class=\"label\">Calculado</div>\n            <div class=\"value\">${view.doseMg} mg</div>\n            ${view.volumeMl ? `<div style=\"font-size: 12px;\">${view.volumeMl} mL</div>` : ''}\n          </div>\n          <div style=\"padding: 10px; background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 4px;\">\n            <div class=\"label\">M√°ximo</div>\n            <div class=\"value\">${view.doseMaxMg} mg</div>\n            ${view.volumeMaxMl ? `<div style=\"font-size: 12px;\">${view.volumeMaxMl} mL</div>` : ''}\n          </div>\n        </div>\n      </div>\n      ` : ''}\n      \n      <div class=\"grid\">\n        ${view.concentracao ? `<div class=\"item\"><div class=\"label\">Concentra√ß√£o</div><div class=\"value\">${view.concentracao} ${view.isComprimido ? 'mg/comprimido' : 'mg/mL'}</div></div>` : ''}\n        ${view.via ? `<div class=\"item\"><div class=\"label\">Via</div><div class=\"value\">${view.via}</div></div>` : ''}\n        <div class=\"item\"><div class=\"label\">Frequ√™ncia</div><div class=\"value\">${view.freq}</div></div>\n        <div class=\"item\"><div class=\"label\">Dura√ß√£o</div><div class=\"value\">${view.dur}</div></div>\n      </div>\n      \n      ${view.notas ? `<div style=\"margin-top: 15px; padding: 10px; background: #faf5ff; border: 1px solid #d8b4fe; border-radius: 4px;\">\n        <div class=\"label\">Notas pessoais</div>\n        <div>${view.notas}</div>\n      </div>` : ''}\n      \n      ${view.alerta ? `<div style=\"margin-top: 15px; padding: 10px; background: #fffbeb; border: 1px solid #fcd34d; border-radius: 4px; color: #92400e;\">\n        ‚ö†Ô∏è ${view.alerta}\n      </div>` : ''}\n      \n      <div style=\"margin-top: 30px; font-size: 12px; color: #6b7280; text-align: center;\">\n        Gerado em ${new Date().toLocaleString('pt-BR')} por VetDose\n      </div>\n    </body>\n    </html>\n  `\n  \n  const win = window.open('', '_blank')\n  win.document.write(html)\n  win.document.close()\n  setTimeout(() => {\n    win.print()\n  }, 250)\n}\n\nfunction renderForm(initial = {}) {\n  const panel = document.getElementById('panel')\n  const especie = initial.especie || 'cachorro'\n  const pesoStr = initial.pesoStr || ''\n  const categoria = initial.categoria || ''\n  const med = initial.med || ''\n  const concStr = initial.concStr || ''\n  const sensivel = Boolean(initial.sensivel)\n  const notas = initial.notas || ''\n\n  // Gerar op√ß√µes de categorias\n  const categoriasOptions = Object.entries(CATEGORIAS).map(([key, cat]) => \n    `<option value=\"${key}\" ${categoria===key?'selected':''}>${cat.nome}</option>`\n  ).join('')\n\n  panel.innerHTML = `\n      <div class=\"mb-4\">\n        <h2 class=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Calcular dosagem</h2>\n        <p class=\"mt-1 text-sm text-gray-600 dark:text-gray-400\">Selecione a categoria, esp√©cie, informe o peso, o medicamento e, opcionalmente, a concentra√ß√£o.</p>\n      </div>\n\n      <form id=\"dose-form\" class=\"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-2\">\n        <div class=\"sm:col-span-2\">\n          <label for=\"animal\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Esp√©cie</label>\n          <select id=\"animal\" class=\"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20\">\n            ${ESPECIES.map(s => `<option value=\"${s.value}\" ${s.value===especie?'selected':''}>${s.label}</option>`).join('')}\n          </select>\n        </div>\n\n        <div>\n          <label for=\"categoria\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Categoria</label>\n          <select id=\"categoria\" class=\"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20\">\n            <option value=\"\">Selecione uma categoria</option>\n            ${categoriasOptions}\n          </select>\n        </div>\n\n        <div>\n          <div class=\"flex items-center justify-between\">\n            <label for=\"medicamento\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Medicamento</label>\n            <button type=\"button\" id=\"toggleFavoritos\" class=\"text-xs text-pink-600 dark:text-pink-400 hover:text-pink-700 dark:hover:text-pink-300 cursor-pointer hidden\" title=\"Mostrar apenas favoritos\">‚≠ê Favoritos</button>\n          </div>\n          <div class=\"mt-1 relative\">\n            <input type=\"text\" id=\"buscaMedicamento\" placeholder=\"Buscar medicamento...\" class=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20\" />\n            <select id=\"medicamento\" class=\"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20 hidden\" ${!categoria ? 'disabled' : ''}>\n              <option value=\"\">Selecione uma categoria</option>\n            </select>\n            <div id=\"medicamento-lista\" class=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto hidden\"></div>\n          </div>\n        </div>\n\n        <div>\n          <label for=\"peso\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Peso <span class=\"text-gray-400 dark:text-gray-500 font-normal\">(kg)</span></label>\n          <div class=\"relative mt-1\">\n            <span class=\"pointer-events-none absolute inset-y-0 left-3 flex items-center text-gray-500 dark:text-gray-400\">kg</span>\n            <input id=\"peso\" inputmode=\"numeric\" autocomplete=\"off\" placeholder=\"0,00\" value=\"${pesoStr}\"\n              aria-label=\"Peso do animal em quilogramas\"\n              class=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 pl-10 pr-3 py-2 text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20\" />\n          </div>\n        </div>\n\n        <div>\n          <label for=\"concentracao\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Concentra√ß√£o <span class=\"text-gray-400 dark:text-gray-500 font-normal\">(mg/mL)</span></label>\n          <div id=\"concentracao-container\" class=\"mt-1\">\n            <input id=\"concentracao\" inputmode=\"decimal\" placeholder=\"Ex.: 250\" value=\"${concStr}\" \n              aria-label=\"Concentra√ß√£o do medicamento em miligramas por mililitro\"\n              class=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20\" />\n            <div id=\"concentracao-opcoes\" class=\"mt-2 hidden\" role=\"group\" aria-label=\"Concentra√ß√µes comuns dispon√≠veis\">\n              <div class=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">Concentra√ß√µes comuns (clique para selecionar):</div>\n              <div class=\"flex flex-wrap gap-2\"></div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex items-center gap-2 sm:col-span-2\">\n          <input id=\"racaSensivel\" type=\"checkbox\" ${sensivel?'checked':''} class=\"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-pink-600 dark:text-pink-400 focus:ring-pink-600 dark:focus:ring-pink-400 bg-white dark:bg-gray-700\" />\n          <label for=\"racaSensivel\" class=\"text-sm text-gray-700 dark:text-gray-300\">Ra√ßa sens√≠vel (Collie/Sheltie) ‚Äî alerta para Ivermectina</label>\n        </div>\n\n        <div class=\"sm:col-span-2\">\n          <label for=\"notas\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Notas pessoais <span class=\"text-gray-400 dark:text-gray-500 font-normal\">(opcional)</span></label>\n          <textarea id=\"notas\" rows=\"2\" placeholder=\"Adicione observa√ß√µes ou notas sobre este c√°lculo...\" class=\"mt-1 w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-sm text-gray-900 dark:text-gray-100 shadow-sm focus:border-pink-500 dark:focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-500/20 dark:focus:ring-pink-400/20 resize-none\"></textarea>\n        </div>\n\n        <div class=\"sm:col-span-2 mt-2\">\n          <button type=\"submit\" aria-label=\"Calcular dosagem do medicamento\" class=\"inline-flex w-full items-center justify-center rounded-md bg-pink-500 dark:bg-pink-600 px-4 py-2 text-white font-medium shadow-sm transition hover:bg-pink-600 dark:hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-pink-500/30 dark:focus:ring-pink-400/30 cursor-pointer\">Calcular dose</button>\n        </div>\n      </form>\n\n      <div id=\"alert\" class=\"mt-4 hidden rounded-md border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/30 px-4 py-3 text-sm text-red-700 dark:text-red-300\"></div>\n  `\n\n  const form = document.getElementById('dose-form')\n  const categoriaSelect = document.getElementById('categoria')\n  const especieSelect = document.getElementById('animal')\n  const pesoInput = document.getElementById('peso')\n  const medicamentoSelect = document.getElementById('medicamento')\n  const buscaMedicamento = document.getElementById('buscaMedicamento')\n  const medicamentoLista = document.getElementById('medicamento-lista')\n  const toggleFavoritos = document.getElementById('toggleFavoritos')\n  const concentracaoInput = document.getElementById('concentracao')\n  const racaSensivel = document.getElementById('racaSensivel')\n  const notasInput = document.getElementById('notas')\n  const alertBox = document.getElementById('alert')\n  \n  // Restaurar notas se houver\n  if (notasInput && notas) {\n    notasInput.value = notas\n  }\n  \n  // Vari√°vel para controlar se est√° mostrando apenas favoritos\n  let mostrarApenasFavoritos = false\n  let medicamentosAtuais = []\n\n  // Fun√ß√£o para extrair concentra√ß√£o do JSON (ex: \"500mg/mL\", \"Comprimidos 50mg\", \"2%\", \"400 mg a cada 5 ml\")\n  function extrairConcentracao(concStr) {\n    if (!concStr) return null\n    \n    // 1. REGRA DO 10 PARA PORCENTAGEM: Se a concentra√ß√£o estiver em %, multiplicar por 10 para obter mg/mL\n    // Exemplo: \"2%\" = 20 mg/mL (2 √ó 10 = 20)\n    const porcentagemRegex = /(\\d+(?:[.,]\\d+)?)\\s*%/i\n    const porcentagemMatch = concStr.match(porcentagemRegex)\n    if (porcentagemMatch) {\n      const porcentagem = parseFloat(porcentagemMatch[1].replace(',', '.'))\n      return round2(porcentagem * 10) // Regra do 10: 2% = 20 mg/mL\n    }\n    \n    // 2. SUSPENS√ïES: \"400 mg a cada 5 ml\" ou \"250 mg/5 mL\" - dividir mg pelos mL para obter mg/mL\n    // Exemplo: \"400 mg a cada 5 ml\" = 400 √∑ 5 = 80 mg/mL\n    const suspensaoRegex = /(\\d+(?:[.,]\\d+)?)\\s*mg\\s*(?:a\\s*cada|em|por|\\/)\\s*(\\d+(?:[.,]\\d+)?)\\s*mL/i\n    const suspensaoMatch = concStr.match(suspensaoRegex)\n    if (suspensaoMatch) {\n      const mg = parseFloat(suspensaoMatch[1].replace(',', '.'))\n      const ml = parseFloat(suspensaoMatch[2].replace(',', '.'))\n      if (ml > 0) {\n        return round2(mg / ml) // Retorna mg/mL\n      }\n    }\n    \n    // 3. PADR√ÉO DIRETO: \"500mg/mL\" ou \"50mg/mL\" - j√° est√° em mg/mL\n    const regex = /(\\d+(?:[.,]\\d+)?)\\s*mg\\s*\\/\\s*(\\d+(?:[.,]\\d+)?)?\\s*mL/i\n    const match = concStr.match(regex)\n    if (match) {\n      const mg = parseFloat(match[1].replace(',', '.'))\n      const ml = match[2] ? parseFloat(match[2].replace(',', '.')) : 1\n      return round2(mg / ml) // Retorna mg/mL\n    }\n    \n    // 4. COMPRIMIDOS: \"Comprimidos 50mg\" ou \"Comp 50mg\" - retorna mg por comprimido\n    const compRegex = /(?:comp|comprimido|cp|tablet|c√°psula|capsula)[\\s:]*(\\d+(?:[.,]\\d+)?)\\s*mg/i\n    const compMatch = concStr.match(compRegex)\n    if (compMatch) {\n      return parseFloat(compMatch[1].replace(',', '.'))\n    }\n    \n    return null\n  }\n\n  // Fun√ß√£o para detectar se √© medica√ß√£o l√≠quida baseado na via\n  function isLiquido(via) {\n    if (!via) return false\n    const viasLiquidas = ['IV', 'IM', 'SC', 'VO', 'INJET√ÅVEL', 'INJETAVEL', 'SOLU√á√ÉO', 'SUSPENS√ÉO', 'SUSPENSAO']\n    return viasLiquidas.some(v => via.toUpperCase().includes(v))\n  }\n\n  // Fun√ß√£o para obter concentra√ß√µes padr√£o de um medicamento\n  function getConcentracoesPadrao(nomeMed) {\n    if (!nomeMed) return null\n    const nomeLower = nomeMed.toLowerCase()\n    // Procurar por nome exato ou parcial\n    for (const [key, valores] of Object.entries(CONCENTRACOES_PADRAO)) {\n      if (nomeLower.includes(key)) {\n        return valores\n      }\n    }\n    return null\n  }\n\n  // Fun√ß√£o para atualizar medicamentos baseado na categoria\n  // Guarda a concentra√ß√£o atual para n√£o perder ao trocar categoria\n  function atualizarMedicamentos() {\n    const categoriaKey = categoriaSelect.value\n    const concAtual = concentracaoInput.value // Guardar concentra√ß√£o atual\n    const medAtual = medicamentoSelect.value // Guardar medicamento atual\n    medicamentoSelect.innerHTML = '<option value=\"\">Selecione uma categoria</option>'\n    medicamentoSelect.disabled = !categoriaKey\n    // N√ÉO desabilitar busca - permitir buscar mesmo sem categoria\n    buscaMedicamento.value = ''\n    medicamentoLista.classList.add('hidden')\n    // S√≥ limpar concentra√ß√£o se realmente mudou de categoria (n√£o quando est√° restaurando)\n    const categoriaAnterior = categoria || ''\n    if (!categoriaAnterior || categoriaAnterior !== categoriaKey) {\n      // Mudou de categoria, limpar concentra√ß√£o\n      concentracaoInput.value = ''\n    } else if (concStr) {\n      // Est√° restaurando, manter concentra√ß√£o salva\n      concentracaoInput.value = concStr\n    }\n\n    if (categoriaKey && CATEGORIAS[categoriaKey]) {\n      const medicamentos = CATEGORIAS[categoriaKey].dados\n      medicamentosAtuais = medicamentos.map((medItem, idx) => {\n        const nome = medItem.Medicamento || medItem.medicamento || `Medicamento ${idx + 1}`\n        const value = nome.toLowerCase().replace(/[^a-z0-9]+/g, '-')\n        return { nome, value, medData: medItem }\n      })\n      \n      // Atualizar select oculto\n      medicamentosAtuais.forEach(item => {\n        medicamentoSelect.innerHTML += `<option value=\"${item.value}\" data-med-data='${JSON.stringify(item.medData)}'>${item.nome}</option>`\n      })\n      \n      // Mostrar bot√£o de favoritos se houver favoritos nesta categoria\n      const favoritos = getFavoritos()\n      const temFavoritos = favoritos.some(f => f.startsWith(`${categoriaKey}:`))\n      if (temFavoritos) {\n        toggleFavoritos.classList.remove('hidden')\n      } else {\n        toggleFavoritos.classList.add('hidden')\n      }\n    } else {\n      medicamentosAtuais = []\n      toggleFavoritos.classList.add('hidden')\n    }\n  }\n  \n  // Fun√ß√£o para buscar e filtrar medicamentos\n  // Agora funciona mesmo sem categoria selecionada - busca em todas as categorias\n  function buscarMedicamentos(termo) {\n    const categoriaKey = categoriaSelect.value\n    let medicamentosFiltrados = []\n    \n    // Se n√£o h√° categoria selecionada, buscar em todas as categorias\n    if (!categoriaKey) {\n      // Buscar em todas as categorias\n      Object.entries(CATEGORIAS).forEach(([catKey, catData]) => {\n        const medicamentos = catData.dados || []\n        medicamentos.forEach((medItem, idx) => {\n          const nome = medItem.Medicamento || medItem.medicamento || `Medicamento ${idx + 1}`\n          const value = nome.toLowerCase().replace(/[^a-z0-9]+/g, '-')\n          medicamentosFiltrados.push({ \n            nome, \n            value, \n            medData: medItem, \n            categoria: catKey,\n            categoriaNome: catData.nome \n          })\n        })\n      })\n    } else {\n      // Se h√° categoria selecionada, usar apenas os medicamentos dessa categoria\n      medicamentosFiltrados = medicamentosAtuais.map(item => ({\n        ...item,\n        categoria: categoriaKey,\n        categoriaNome: CATEGORIAS[categoriaKey]?.nome || ''\n      }))\n    }\n    \n    // Filtrar por favoritos se estiver ativo\n    if (mostrarApenasFavoritos) {\n      const favoritos = getFavoritos()\n      const categoriaKey = categoriaSelect.value\n      medicamentosFiltrados = medicamentosFiltrados.filter(item => {\n        const key = `${categoriaKey}:${item.value}`\n        return favoritos.includes(key)\n      })\n    }\n    \n    // Filtrar por termo de busca\n    if (termo && termo.trim()) {\n      const termoLower = termo.toLowerCase()\n      medicamentosFiltrados = medicamentosFiltrados.filter(item => \n        item.nome.toLowerCase().includes(termoLower)\n      )\n    }\n    \n    // Renderizar lista\n    if (medicamentosFiltrados.length === 0) {\n      medicamentoLista.innerHTML = '<div class=\"px-3 py-2 text-sm text-gray-500 dark:text-gray-400\">Nenhum medicamento encontrado</div>'\n      medicamentoLista.classList.remove('hidden')\n      return\n    }\n    \n    // Separar favoritos e n√£o-favoritos\n    const favoritos = getFavoritos()\n    const medicamentosFavoritos = []\n    const medicamentosNaoFavoritos = []\n    \n    medicamentosFiltrados.forEach(item => {\n      const itemCategoria = item.categoria || categoriaSelect.value\n      const key = `${itemCategoria}:${item.value}`\n      if (favoritos.includes(key)) {\n        medicamentosFavoritos.push(item)\n      } else {\n        medicamentosNaoFavoritos.push(item)\n      }\n    })\n    \n    // Ordenar alfabeticamente cada grupo\n    medicamentosFavoritos.sort((a, b) => a.nome.localeCompare(b.nome, 'pt-BR'))\n    medicamentosNaoFavoritos.sort((a, b) => a.nome.localeCompare(b.nome, 'pt-BR'))\n    \n    // Combinar: favoritos primeiro, depois n√£o-favoritos\n    const medicamentosOrdenados = [...medicamentosFavoritos, ...medicamentosNaoFavoritos]\n    \n    medicamentoLista.innerHTML = ''\n    medicamentosOrdenados.forEach(item => {\n      const itemCategoria = item.categoria || categoriaSelect.value\n      const favorito = isFavorito(item.value, itemCategoria)\n      const div = document.createElement('div')\n      div.className = 'px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer flex items-center justify-between'\n      div.innerHTML = `\n        <div class=\"flex-1\">\n          <span class=\"text-sm text-gray-900 dark:text-gray-100\">${item.nome}</span>\n          ${item.categoriaNome ? `<span class=\"text-xs text-gray-500 dark:text-gray-400 ml-2\">(${item.categoriaNome})</span>` : ''}\n        </div>\n        <button type=\"button\" class=\"favorito-btn text-lg ${favorito ? 'text-yellow-500' : 'text-gray-400'} hover:text-yellow-500 transition\" data-med=\"${item.value}\" data-cat=\"${itemCategoria}\" title=\"${favorito ? 'Remover dos favoritos' : 'Adicionar aos favoritos'}\">\n          ${favorito ? '‚≠ê' : '‚òÜ'}\n        </button>\n      `\n      div.onclick = (e) => {\n        if (e.target.closest('.favorito-btn')) {\n          e.stopPropagation()\n          const btn = e.target.closest('.favorito-btn')\n          const medValue = btn.dataset.med\n          const medCategoria = btn.dataset.cat\n          if (isFavorito(medValue, medCategoria)) {\n            removerFavorito(medValue, medCategoria)\n          } else {\n            salvarFavorito(medValue, medCategoria)\n          }\n          // Atualizar a lista para reordenar (favoritos no topo)\n          buscarMedicamentos(buscaMedicamento.value || '')\n          return\n        }\n        // Selecionar medicamento - se n√£o tinha categoria, selecionar automaticamente\n        if (!categoriaSelect.value && item.categoria) {\n          categoriaSelect.value = item.categoria\n          atualizarMedicamentos()\n          // Aguardar um pouco para garantir que os medicamentos foram carregados\n          setTimeout(() => {\n            medicamentoSelect.value = item.value\n            buscaMedicamento.value = item.nome\n            medicamentoLista.classList.add('hidden')\n            medicamentoSelect.dispatchEvent(new Event('change'))\n          }, 100)\n        } else {\n          medicamentoSelect.value = item.value\n          buscaMedicamento.value = item.nome\n          medicamentoLista.classList.add('hidden')\n          medicamentoSelect.dispatchEvent(new Event('change'))\n        }\n      }\n      medicamentoLista.appendChild(div)\n    })\n    \n    // Mostrar lista se houver medicamentos filtrados\n    if (medicamentosFiltrados.length > 0) {\n      medicamentoLista.classList.remove('hidden')\n    } else {\n      medicamentoLista.classList.add('hidden')\n    }\n  }\n  \n  // Event listeners para busca\n  buscaMedicamento.addEventListener('input', (e) => {\n    buscarMedicamentos(e.target.value)\n  })\n  \n  buscaMedicamento.addEventListener('focus', () => {\n    // Mostrar todos os medicamentos quando focar, mesmo sem digitar\n    // Se n√£o h√° categoria, mostra todos de todas as categorias\n    buscarMedicamentos(buscaMedicamento.value || '')\n  })\n  \n  // Fechar lista ao clicar fora\n  document.addEventListener('click', (e) => {\n    if (!buscaMedicamento.contains(e.target) && !medicamentoLista.contains(e.target)) {\n      medicamentoLista.classList.add('hidden')\n    }\n  })\n  \n  // Toggle favoritos\n  toggleFavoritos.addEventListener('click', () => {\n    mostrarApenasFavoritos = !mostrarApenasFavoritos\n    toggleFavoritos.textContent = mostrarApenasFavoritos ? 'üìã Todos' : '‚≠ê Favoritos'\n    buscarMedicamentos(buscaMedicamento.value)\n  })\n\n  // Quando medicamento for selecionado, preencher concentra√ß√£o automaticamente APENAS se estiver no JSON\n  // Mas s√≥ limpar se realmente mudou de medicamento (n√£o quando est√° restaurando)\n  let medicamentoAnterior = medicamentoSelect.value || med || ''\n  medicamentoSelect.addEventListener('change', () => {\n    const medOption = medicamentoSelect.options[medicamentoSelect.selectedIndex]\n    const opcoesContainer = document.getElementById('concentracao-opcoes')\n    opcoesContainer.innerHTML = ''\n    opcoesContainer.classList.add('hidden')\n    \n    // S√≥ limpar concentra√ß√£o se realmente mudou de medicamento E n√£o tinha concentra√ß√£o salva\n    const medAtual = medicamentoSelect.value\n    const tinhaConcSalva = concStr && concStr.trim() !== ''\n    const mesmoMedicamento = medAtual === med\n    \n    // Se mudou de medicamento E n√£o est√° restaurando o mesmo, limpar\n    if (medicamentoAnterior !== medAtual && !(mesmoMedicamento && tinhaConcSalva)) {\n      concentracaoInput.value = ''\n    }\n    // Se est√° restaurando o mesmo medicamento e tinha concentra√ß√£o, manter\n    else if (mesmoMedicamento && tinhaConcSalva) {\n      concentracaoInput.value = concStr\n    }\n    \n    medicamentoAnterior = medAtual\n    \n    if (medOption?.dataset?.medData) {\n      const medData = JSON.parse(medOption.dataset.medData)\n      const nomeMed = medData.Medicamento || ''\n      const via = medData.Via || ''\n      \n      // Se j√° tem concentra√ß√£o informada, n√£o sobrescrever\n      if (concentracaoInput.value && concentracaoInput.value.trim() !== '') {\n        // Manter a concentra√ß√£o que j√° estava\n        return\n      }\n      \n      // Tentar extrair do JSON - S√ì preencher se encontrar informa√ß√£o v√°lida\n      if (medData.Concentracao_mg_mL) {\n        const concExtraida = extrairConcentracao(medData.Concentracao_mg_mL)\n        if (concExtraida && concExtraida > 0) {\n          // S√≥ preencher se conseguiu extrair uma concentra√ß√£o v√°lida do JSON\n          concentracaoInput.value = formatNumber(concExtraida)\n        } else {\n          // Se n√£o conseguiu extrair, mas √© l√≠quido, mostrar op√ß√µes como sugest√£o (SEM preencher)\n          if (isLiquido(via)) {\n            const concPadrao = getConcentracoesPadrao(nomeMed)\n            if (concPadrao && concPadrao.length > 0) {\n              opcoesContainer.classList.remove('hidden')\n              const buttonsContainer = opcoesContainer.querySelector('div')\n              buttonsContainer.innerHTML = ''\n              concPadrao.forEach(conc => {\n                const btn = document.createElement('button')\n                btn.type = 'button'\n                btn.className = 'px-3 py-1 text-xs rounded-md bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 hover:bg-pink-200 dark:hover:bg-pink-900/50 transition cursor-pointer'\n                btn.textContent = `${formatNumber(conc)} mg/mL`\n                btn.onclick = () => {\n                  concentracaoInput.value = formatNumber(conc)\n                  opcoesContainer.classList.add('hidden')\n                }\n                buttonsContainer.appendChild(btn)\n              })\n              // N√ÉO preencher automaticamente - apenas mostrar op√ß√µes\n            }\n          }\n        }\n      } else {\n        // Se n√£o tem concentra√ß√£o no JSON e √© l√≠quido, mostrar op√ß√µes como sugest√£o (SEM preencher)\n        if (isLiquido(via)) {\n          const concPadrao = getConcentracoesPadrao(nomeMed)\n          if (concPadrao && concPadrao.length > 0) {\n            opcoesContainer.classList.remove('hidden')\n            const buttonsContainer = opcoesContainer.querySelector('div')\n            buttonsContainer.innerHTML = ''\n            concPadrao.forEach(conc => {\n              const btn = document.createElement('button')\n              btn.type = 'button'\n              btn.className = 'px-3 py-1 text-xs rounded-md bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 hover:bg-pink-200 dark:hover:bg-pink-900/50 transition cursor-pointer'\n              btn.textContent = `${formatNumber(conc)} mg/mL`\n              btn.onclick = () => {\n                concentracaoInput.value = formatNumber(conc)\n                opcoesContainer.classList.add('hidden')\n              }\n              buttonsContainer.appendChild(btn)\n            })\n            // N√ÉO preencher automaticamente - apenas mostrar op√ß√µes\n          }\n        }\n      }\n    }\n  })\n\n  // Se j√° tinha categoria selecionada, atualizar medicamentos\n  if (categoria) {\n    atualizarMedicamentos()\n    if (med) {\n      medicamentoSelect.value = med\n    }\n  }\n\n  categoriaSelect.addEventListener('change', atualizarMedicamentos)\n\n  function maskDecimal(el) {\n    el.addEventListener('input', () => {\n      let s = el.value\n      s = s.replace(/[^\\d,\\.]/g, '')\n      s = s.replace(/\\./g, '')\n      if (s.indexOf(',') !== -1) {\n        const [int, dec] = s.split(',')\n        const intFmt = int.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.')\n        el.value = dec !== undefined ? `${intFmt},${dec.replace(/[^\\d]/g,'').slice(0,2)}` : intFmt\n      } else {\n        const intFmt = s.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.')\n        el.value = intFmt\n      }\n    })\n  }\n\n  // M√°scara de 2 casas decimais autom√°tica (ex.: 1250 -> 12,50)\n  function maskTwoDecimals(el) {\n    const format = (digits) => {\n      if (!digits) return ''\n      // remove zeros √† esquerda\n      digits = digits.replace(/^0+(\\d)/, '$1')\n      if (digits.length === 1) digits = '0' + digits\n      const intPart = digits.slice(0, -2) || '0'\n      const decPart = digits.slice(-2)\n      const intFmt = intPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.')\n      return `${intFmt},${decPart}`\n    }\n    const handler = () => {\n      let s = el.value.replace(/\\D/g, '')\n      el.value = format(s)\n    }\n    el.addEventListener('input', handler)\n    el.addEventListener('focus', handler)\n  }\n\n  maskTwoDecimals(pesoInput)\n  maskDecimal(concentracaoInput)\n\n  function parsePtBrNumber(str) {\n    if (!str) return NaN\n    return Number(str.replace(/\\./g,'').replace(',', '.'))\n  }\n\n  function showAlert(message) {\n    alertBox.textContent = message\n    alertBox.classList.remove('hidden')\n  }\n\n  form.addEventListener('submit', async (e) => {\n    e.preventDefault()\n    const submitBtn = form.querySelector('button[type=\"submit\"]')\n    const originalText = submitBtn.innerHTML\n    \n    // Loading state\n    submitBtn.disabled = true\n    submitBtn.innerHTML = '<span class=\"inline-block animate-spin mr-2\">‚è≥</span> Calculando...'\n    \n    // Simular pequeno delay para melhor UX (opcional - pode remover se quiser instant√¢neo)\n    await new Promise(resolve => setTimeout(resolve, 300))\n    \n    const categoriaKey = categoriaSelect.value\n    const especie = especieSelect.value\n    const peso = parsePtBrNumber(pesoInput.value)\n    const medOption = medicamentoSelect.options[medicamentoSelect.selectedIndex]\n    const medData = medOption?.dataset?.medData ? JSON.parse(medOption.dataset.medData) : null\n    const med = medicamentoSelect.value\n    const conc = parsePtBrNumber(concentracaoInput.value)\n    const sens = racaSensivel.checked\n    const notas = notasInput ? notasInput.value.trim() : ''\n    \n    calcular({ \n      categoria: categoriaKey,\n      especie, \n      peso, \n      med, \n      medData,\n      conc, \n      sens,\n      notas,\n      raw: {pesoStr:pesoInput.value, concStr:concentracaoInput.value, categoria: categoriaKey, notas} \n    })\n    \n    // Restaurar bot√£o\n    submitBtn.disabled = false\n    submitBtn.innerHTML = originalText\n  })\n}\n\nfunction renderResultado(view) {\n  const panel = document.getElementById('panel')\n  const especieLabel = ESPECIES.find(e => e.value === view.especie)?.label || view.especie\n  const temFaixa = view.doseMinKg !== view.doseMaxKg\n  \n  // Anima√ß√£o de entrada\n  panel.style.opacity = '0'\n  panel.style.transform = 'translateY(10px)'\n  \n  panel.innerHTML = `\n    <button id=\\\"voltar\\\" aria-label=\\\"Voltar para o formul√°rio\\\" class=\\\"-ml-2 inline-flex items-center gap-2 rounded-md px-2 py-1 text-sm text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 cursor-pointer bg-transparent hover:bg-gray-100 dark:hover:bg-gray-700 transition\\\"><span>‚Üê</span><span>Voltar</span></button>\n    <div class=\\\"mt-3 rounded-xl bg-white dark:bg-gray-800 p-6 shadow-md ring-1 ring-black/5 dark:ring-gray-700\\\">\n      <div class=\\\"text-base font-semibold text-gray-900 dark:text-gray-100\\\">Plano de cuidado</div>\n      <div class=\\\"mt-2 text-sm text-gray-700 dark:text-gray-300\\\">\n        <span class=\\\"font-medium\\\">${especieLabel}</span> ‚Ä¢ <span class=\\\"font-medium\\\">${view.med}</span>\n        ${view.peso ? ` ‚Ä¢ <span class=\\\"text-gray-600 dark:text-gray-400\\\">${formatNumber(view.peso)} kg</span>` : ''}\n      </div>\n      ${view.classe ? `<div class=\\\"mt-1 text-xs text-gray-500 dark:text-gray-400\\\">Classe: ${view.classe}</div>` : ''}\n\n      <div class=\\\"mt-4\\\">\n        <div class=\\\"text-xs text-gray-500 dark:text-gray-400 mb-2\\\">Dosagem de refer√™ncia: ${view.faixaStr}</div>\n        ${temFaixa ? `\n        <div class=\\\"grid grid-cols-1 sm:grid-cols-3 gap-2 text-center\\\">\n          <div class=\\\"rounded-lg bg-red-50 dark:bg-red-900/20 px-2 py-3 border border-red-200 dark:border-red-800 break-words\\\">\n            <div class=\\\"text-xs text-red-600 dark:text-red-400 font-medium mb-1\\\">M√≠nimo</div>\n            <div class=\\\"text-sm sm:text-base font-bold text-red-700 dark:text-red-300 break-words\\\">${view.doseMinMg} mg</div>\n            ${view.isComprimido ? '' : `<div class=\\\"text-xs text-red-600 dark:text-red-400 mt-1 break-words\\\">${view.volumeMinMl} mL</div>`}\n            ${view.comprimidosMin !== null ? `<div class=\\\"text-xs text-red-500 dark:text-red-400 mt-1 break-words\\\">${view.comprimidosMin} comprimido(s)</div>` : ''}\n          </div>\n          <div class=\\\"rounded-lg bg-green-50 dark:bg-green-900/20 px-2 py-3 border-2 border-green-300 dark:border-green-600 break-words\\\">\n            <div class=\\\"text-xs text-green-600 dark:text-green-400 font-medium mb-1\\\">Calculado</div>\n            <div class=\\\"text-base sm:text-lg font-bold text-green-700 dark:text-green-300 break-words\\\">${view.doseMg} mg</div>\n            ${view.isComprimido ? '' : `<div class=\\\"text-xs text-green-600 dark:text-green-400 mt-1 break-words\\\">${view.volumeMl} mL</div>`}\n            ${view.comprimidos !== null ? `<div class=\\\"text-xs text-green-500 dark:text-green-400 mt-1 break-words\\\">${view.comprimidos} comprimido(s)</div>` : ''}\n          </div>\n          <div class=\\\"rounded-lg bg-blue-50 dark:bg-blue-900/20 px-2 py-3 border border-blue-200 dark:border-blue-800 break-words\\\">\n            <div class=\\\"text-xs text-blue-600 dark:text-blue-400 font-medium mb-1\\\">M√°ximo</div>\n            <div class=\\\"text-sm sm:text-base font-bold text-blue-700 dark:text-blue-300 break-words\\\">${view.doseMaxMg} mg</div>\n            ${view.isComprimido ? '' : `<div class=\\\"text-xs text-blue-600 dark:text-blue-400 mt-1 break-words\\\">${view.volumeMaxMl} mL</div>`}\n            ${view.comprimidosMax !== null ? `<div class=\\\"text-xs text-blue-500 dark:text-blue-400 mt-1 break-words\\\">${view.comprimidosMax} comprimido(s)</div>` : ''}\n          </div>\n        </div>\n        ` : `\n        <div class=\\\"rounded-lg bg-green-50 dark:bg-green-900/20 px-4 py-3 border-2 border-green-300 dark:border-green-600 text-center\\\">\n          <div class=\\\"text-xs text-green-600 dark:text-green-400 font-medium mb-1\\\">Dose</div>\n          <div class=\\\"text-2xl font-bold text-green-700 dark:text-green-300\\\">${view.doseMg} mg</div>\n          ${view.isComprimido ? '' : `<div class=\\\"text-sm text-green-600 dark:text-green-400 mt-1\\\">${view.volumeMl} mL</div>`}\n          ${view.comprimidos !== null ? `<div class=\\\"text-xs text-green-500 dark:text-green-400 mt-1\\\">${view.comprimidos} comprimido(s) de ${view.concentracao} mg</div>` : ''}\n        </div>\n        `}\n      </div>\n\n      <div class=\\\"mt-4 grid grid-cols-1 gap-2 sm:grid-cols-2\\\">\n        ${view.concentracao ? `\n        <div class=\\\"rounded-lg bg-gray-50 dark:bg-gray-700 px-3 py-2\\\">\n          <div class=\\\"text-xs text-gray-500 dark:text-gray-400\\\">Concentra√ß√£o utilizada</div>\n          <div class=\\\"font-medium text-gray-900 dark:text-gray-100\\\">${view.concentracao} ${view.isComprimido ? 'mg/comprimido' : 'mg/mL'}</div>\n        </div>\n        ` : ''}\n        ${view.via ? `\n        <div class=\\\"rounded-lg bg-gray-50 dark:bg-gray-700 px-3 py-2\\\">\n          <div class=\\\"text-xs text-gray-500 dark:text-gray-400\\\">Via de administra√ß√£o</div>\n          <div class=\\\"font-medium text-gray-900 dark:text-gray-100\\\">${view.via}</div>\n        </div>\n        ` : ''}\n        <div class=\\\"rounded-lg bg-gray-50 dark:bg-gray-700 px-3 py-2\\\">\n          <div class=\\\"text-xs text-gray-500 dark:text-gray-400\\\">Frequ√™ncia</div>\n          <div class=\\\"font-medium text-gray-900 dark:text-gray-100\\\">${view.freq}</div>\n        </div>\n        <div class=\\\"rounded-lg bg-gray-50 dark:bg-gray-700 px-3 py-2\\\">\n          <div class=\\\"text-xs text-gray-500 dark:text-gray-400\\\">Dura√ß√£o</div>\n          <div class=\\\"font-medium text-gray-900 dark:text-gray-100\\\">${view.dur}</div>\n        </div>\n      </div>\n\n      <div class=\\\"mt-4 border-t dark:border-gray-700 pt-4 space-y-2\\\">\n        ${view.medData?.Concentracao_mg_mL ? `\n        <div class=\\\"rounded-lg bg-blue-50 dark:bg-blue-900/20 px-3 py-2 border border-blue-100 dark:border-blue-800\\\">\n          <div class=\\\"text-xs text-blue-600 dark:text-blue-400 font-medium mb-1\\\">Concentra√ß√µes dispon√≠veis</div>\n          <div class=\\\"text-sm text-blue-700 dark:text-blue-300\\\">${view.medData.Concentracao_mg_mL}</div>\n        </div>\n        ` : ''}\n      </div>\n      ${view.alerta ? `<div class=\\\"mt-3 rounded border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/30 px-3 py-2 text-sm text-amber-800 dark:text-amber-300\\\">‚ö†Ô∏è ${view.alerta}</div>` : ''}\n      \n      ${view.notas ? `<div class=\\\"mt-3 rounded-lg bg-purple-50 dark:bg-purple-900/20 px-3 py-2 border border-purple-200 dark:border-purple-800\\\">\n        <div class=\\\"text-xs text-purple-600 dark:text-purple-400 font-medium mb-1\\\">Notas pessoais</div>\n        <div class=\\\"text-sm text-purple-700 dark:text-purple-300\\\">${view.notas}</div>\n      </div>` : ''}\n      \n      <div class=\\\"mt-4 flex gap-2 justify-end\\\">\n        <button id=\\\"exportarPDF\\\" class=\\\"px-4 py-2 text-sm rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 transition cursor-pointer\\\">üìÑ PDF</button>\n        <button id=\\\"imprimir\\\" class=\\\"px-4 py-2 text-sm rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 transition cursor-pointer\\\">üñ®Ô∏è Imprimir</button>\n      </div>\n    </div>\n  `\n  \n  // Anima√ß√£o de entrada\n  requestAnimationFrame(() => {\n    panel.style.transition = 'opacity 0.3s ease, transform 0.3s ease'\n    panel.style.opacity = '1'\n    panel.style.transform = 'translateY(0)'\n  })\n  \n  // Scroll suave para o resultado\n  setTimeout(() => {\n    panel.scrollIntoView({ behavior: 'smooth', block: 'start' })\n  }, 100)\n  \n  // Bot√£o imprimir\n  document.getElementById('imprimir').addEventListener('click', () => {\n    window.print()\n  })\n  \n  // Bot√£o exportar PDF\n  document.getElementById('exportarPDF').addEventListener('click', () => {\n    exportarPDF(view)\n  })\n  \n  document.getElementById('voltar').addEventListener('click', () => {\n    renderForm(view.formState)\n    // Restaurar categoria e medicamentos\n    if (view.formState.categoria) {\n      const categoriaSelect = document.getElementById('categoria')\n      categoriaSelect.value = view.formState.categoria\n      categoriaSelect.dispatchEvent(new Event('change'))\n      setTimeout(() => {\n        const medicamentoSelect = document.getElementById('medicamento')\n        const concentracaoInput = document.getElementById('concentracao')\n        if (view.formState.med) {\n          medicamentoSelect.value = view.formState.med\n          // Disparar evento change para restaurar concentra√ß√£o do JSON se necess√°rio\n          medicamentoSelect.dispatchEvent(new Event('change'))\n        }\n        // Restaurar concentra√ß√£o que estava salva\n        if (view.formState.concStr) {\n          concentracaoInput.value = view.formState.concStr\n        }\n      }, 150)\n    }\n  })\n}\n\nfunction calcular({ categoria, especie, peso, med, medData, conc, sens, raw }) {\n  const panel = document.getElementById('panel')\n  \n  // Limpar mensagens de erro anteriores\n  const existingAlerts = panel.querySelectorAll('.alert-error')\n  existingAlerts.forEach(alert => alert.remove())\n  \n  const alertMsg = (msg) => {\n    const alertEl = document.createElement('div')\n    alertEl.className = 'alert-error mt-4 rounded-md border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/30 px-4 py-3 text-sm text-red-700 dark:text-red-300'\n    alertEl.textContent = msg\n    panel.insertAdjacentElement('beforeend', alertEl)\n    // Scroll suave para o erro\n    alertEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' })\n  }\n\n  if (!Number.isFinite(peso)) return alertMsg('Informe um peso v√°lido (n√∫mero).')\n  if (peso <= 0) return alertMsg('Peso deve ser maior que zero.')\n  if (peso < limitesPesoKg.min) return alertMsg(`Peso muito baixo. M√≠nimo: ${limitesPesoKg.min} kg.`)\n  if (peso > limitesPesoKg.max) return alertMsg(`Peso muito alto. M√°ximo: ${limitesPesoKg.max} kg.`)\n  if (!categoria) return alertMsg('Selecione uma categoria de medicamento.')\n  if (!med) return alertMsg('Selecione um medicamento.')\n  \n  // Detectar se √© comprimido ANTES de validar concentra√ß√£o\n  const concStr = medData?.Concentracao_mg_mL || ''\n  let isComprimido = /comprimido|comp|cp|tablet|c√°psula|capsula/i.test(concStr)\n  \n  // Se n√£o for comprimido, concentra√ß√£o √© obrigat√≥ria\n  if (!isComprimido && (!raw.concStr || !Number.isFinite(conc) || conc <= 0)) {\n    return alertMsg('Concentra√ß√£o √© obrigat√≥ria. Informe um valor em mg/mL maior que 0.')\n  }\n  \n  // Se for comprimido mas n√£o informou concentra√ß√£o, usar conc = 0 para n√£o calcular volumes/comprimidos\n  if (isComprimido && (!raw.concStr || !Number.isFinite(conc) || conc <= 0)) {\n    conc = 0 // Ser√° usado apenas para mostrar dose em mg\n  }\n\n  let regra = null\n  let medNome = med\n\n  // Tentar usar dados do JSON primeiro\n  if (medData && medData.Dose_mg_kg) {\n    const doseParsed = parseDoseFromJSON(medData.Dose_mg_kg, especie)\n    if (doseParsed) {\n      medNome = medData.Medicamento || med\n      regra = {\n        min: doseParsed.min,\n        max: doseParsed.max,\n        freq: medData.Frequencia || 'Conforme prescri√ß√£o',\n        dur: 'Conforme prescri√ß√£o',\n        obs: medData.Observacoes || medData.Via || ''\n      }\n    }\n  }\n\n  // Se n√£o encontrou nos JSONs, tentar no DOSAGENS antigo\n  if (!regra) {\n    regra = getRegra(med, especie)\n  }\n  \n  // Se ainda n√£o encontrou protocolo, usar f√≥rmula padr√£o baseada no tipo de medicamento\n  if (!regra) {\n    // F√≥rmulas padr√£o conforme infos.md: Dose (mg/kg) √ó Peso (kg) = Quantidade (mg)\n    // Para medicamentos sem protocolo, usar uma faixa conservadora gen√©rica\n    // Baseado em padr√µes comuns: analg√©sicos opioides geralmente 0,1-2mg/kg, antibi√≥ticos 5-20mg/kg, etc.\n    const medLower = med.toLowerCase()\n    let dosePadrao = null\n    \n    // Tentar inferir dose padr√£o baseado no nome ou categoria\n    if (medLower.includes('fentanil') || medLower.includes('opioide') || medLower.includes('analg√©sico')) {\n      dosePadrao = { min: 0.001, max: 0.005 } // 1-5 mcg/kg convertido para mg (0,001-0,005 mg/kg)\n    } else if (medLower.includes('antibi√≥tico') || medLower.includes('amoxicilina') || medLower.includes('cefalexina')) {\n      dosePadrao = { min: 10, max: 20 }\n    } else if (medLower.includes('anti-inflamat√≥rio') || medLower.includes('carprofeno') || medLower.includes('meloxicam')) {\n      dosePadrao = { min: 0.1, max: 0.2 }\n    } else if (medLower.includes('diur√©tico') || medLower.includes('furosemida')) {\n      dosePadrao = { min: 2, max: 6 }\n    } else {\n      // Dose gen√©rica conservadora para medicamentos desconhecidos\n      dosePadrao = { min: 1, max: 5 }\n    }\n    \n    if (dosePadrao) {\n      regra = {\n        min: dosePadrao.min,\n        max: dosePadrao.max,\n        freq: 'Conforme prescri√ß√£o veterin√°ria',\n        dur: 'Conforme prescri√ß√£o veterin√°ria',\n        obs: '‚ö†Ô∏è Protocolo espec√≠fico n√£o encontrado. Dose calculada com base em f√≥rmula padr√£o do tipo de medicamento. Sempre consulte literatura espec√≠fica ou veterin√°rio antes de administrar.'\n      }\n    } else {\n      return alertMsg('N√£o h√° protocolo cadastrado para esta combina√ß√£o de medicamento e esp√©cie. Consulte literatura espec√≠fica ou veterin√°rio.')\n    }\n  }\n\n  // ============================================\n  // C√ÅLCULO DE DOSAGEM - SEGUINDO AS F√ìRMULAS CORRETAS\n  // ============================================\n  // PASSO 1: Calcular mg totais necess√°rios\n  // F√≥rmula: Peso (kg) √ó Dosagem (mg/kg) = Quantidade em mg\n  const doseMinMg = round2(peso * regra.min)\n  const doseMaxMg = round2(peso * regra.max)\n  const mgKg = regra.min === regra.max ? regra.min : (regra.min + regra.max) / 2\n  const doseMgNum = round2(peso * mgKg) // Dose m√©dia calculada\n  \n  // Se n√£o detectou como comprimido pelo JSON mas tem concentra√ß√£o alta, pode ser comprimido\n  if (!isComprimido && conc > 0) {\n    const isComprimidoByValue = (conc >= 50 && conc <= 1000 && !/mg\\s*\\/\\s*\\d+\\s*mL/i.test(concStr))\n    if (isComprimidoByValue) {\n      isComprimido = true\n    }\n  }\n  \n  // PASSO 2: Calcular volumes em mL (para l√≠quidos/injet√°veis)\n  // F√≥rmula: Volume (mL) = (Peso √ó Dosagem) √∑ Concentra√ß√£o = mg totais √∑ concentra√ß√£o (mg/mL)\n  // Aplicar apenas se tiver concentra√ß√£o informada E n√£o for comprimido\n  const volumeMinMl = (conc > 0 && !isComprimido) ? round2(doseMinMg / conc) : null\n  const volumeMaxMl = (conc > 0 && !isComprimido) ? round2(doseMaxMg / conc) : null\n  const volumeMlNum = (conc > 0 && !isComprimido) ? round2(doseMgNum / conc) : null\n  \n  // PASSO 3: Calcular comprimidos\n  // F√≥rmula: Comprimidos = mg totais √∑ mg por comprimido\n  // Exemplo: 100 mg necess√°rios √∑ 50 mg por comprimido = 2 comprimidos\n  // Exemplo: 25 mg necess√°rios √∑ 50 mg por comprimido = 0,5 comprimidos (meio comprimido)\n  // Arredondar para 2 casas decimais, permitindo meios comprimidos (0,5)\n  // S√≥ calcula se for comprimido E tiver concentra√ß√£o informada\n  const comprimidosMin = (isComprimido && conc > 0) ? round2(doseMinMg / conc) : null\n  const comprimidosMax = (isComprimido && conc > 0) ? round2(doseMaxMg / conc) : null\n  const comprimidos = (isComprimido && conc > 0) ? round2(doseMgNum / conc) : null\n\n  const faixaStr = regra.min === regra.max ? `${regra.min} mg/kg` : `${regra.min}‚Äì${regra.max} mg/kg`\n  const alerta = (med.includes('ivermectina') && especie === 'cachorro' && sens)\n    ? 'Aten√ß√£o: Ivermectina pode ser contraindicada em ra√ßas sens√≠veis (MDR1).'\n    : ''\n\n  renderResultado({\n    especie,\n    med: medNome,\n    peso: peso,\n    doseMinMg: formatNumber(doseMinMg),\n    doseMaxMg: formatNumber(doseMaxMg),\n    doseMg: formatNumber(doseMgNum),\n    volumeMinMl: volumeMinMl !== null ? formatNumber(volumeMinMl) : null,\n    volumeMaxMl: volumeMaxMl !== null ? formatNumber(volumeMaxMl) : null,\n    volumeMl: volumeMlNum !== null ? formatNumber(volumeMlNum) : null,\n    concentracao: conc > 0 ? formatNumber(conc) : null,\n    comprimidosMin: (isComprimido && comprimidosMin !== null) ? formatNumber(comprimidosMin) : null,\n    comprimidosMax: (isComprimido && comprimidosMax !== null) ? formatNumber(comprimidosMax) : null,\n    comprimidos: (isComprimido && comprimidos !== null) ? formatNumber(comprimidos) : null,\n    isComprimido: isComprimido,\n    via: medData?.Via || '',\n    freq: regra.freq,\n    dur: regra.dur,\n    faixaStr,\n    doseMinKg: regra.min,\n    doseMaxKg: regra.max,\n    obs: regra.obs,\n    alerta,\n    medData: medData || null,\n    classe: medData?.Classe || '',\n    notas: raw.notas || '',\n    formState: { especie, pesoStr: raw.pesoStr, categoria: raw.categoria, med, concStr: raw.concStr, sensivel: sens, notas: raw.notas || '' },\n  })\n  \n  // Salvar no hist√≥rico\n  salvarHistorico({\n    especie,\n    med: medNome,\n    peso,\n    doseMg: doseMgNum,\n    doseMinMg,\n    doseMaxMg,\n    volumeMl: volumeMlNum,\n    concentracao: conc,\n    categoria,\n    notas: raw.notas || ''\n  })\n}\n\n// Inicializa view\nrenderForm()\n\n\n"],"names":["logoUrl","CATEGORIAS","analgesicosOpioides","antiHistaminico","antiInflamatorio","antiarritmicos","antibioticos","anticonvulsivantes","antiemeticos","antifungicos","antiparasitarios","antiulcerosos","corticoesteroides","diureticos","laxantesAntigases","outros","sistemaRespiratorio","vasodilatadores","vasopressores","vitaminas","app","aplicarTema","temaSalvo","html","alternarTema","atualizarIconeTema","temaIcon","isDark","toggleTema","novoBtn","btn","e","historicoBtn","mostrarHistorico","historico","getHistorico","panel","renderForm","item","idx","data","especieLabel","ESPECIES","formatNumber","limparHistorico","el","splashEl","DOSAGENS","limitesPesoKg","CONCENTRACOES_PADRAO","round2","n","getRegra","medicamento","especie","mapa","parseDoseFromJSON","doseStr","especieTerms","converterUnidade","valor","unidade","term","especieRegex","especieMatch","parteEspecie","faixaRegex","faixaMatch","min","max","singleRegex","singleMatch","val","valorConvertido","multiRegex","multiMatch","values","regex","match","getFavoritos","salvarFavorito","categoria","favoritos","key","removerFavorito","index","isFavorito","salvarHistorico","calculo","historicoLimitado","exportarPDF","view","temFaixa","win","initial","pesoStr","med","concStr","sensivel","notas","categoriasOptions","cat","s","form","categoriaSelect","especieSelect","pesoInput","medicamentoSelect","buscaMedicamento","medicamentoLista","toggleFavoritos","concentracaoInput","racaSensivel","notasInput","mostrarApenasFavoritos","medicamentosAtuais","extrairConcentracao","porcentagemRegex","porcentagemMatch","porcentagem","suspensaoRegex","suspensaoMatch","mg","ml","compRegex","compMatch","isLiquido","via","v","getConcentracoesPadrao","nomeMed","nomeLower","valores","atualizarMedicamentos","categoriaKey","categoriaAnterior","medItem","nome","value","f","buscarMedicamentos","termo","medicamentosFiltrados","catKey","catData","termoLower","medicamentosFavoritos","medicamentosNaoFavoritos","a","b","medicamentosOrdenados","itemCategoria","favorito","div","medValue","medCategoria","medicamentoAnterior","medOption","opcoesContainer","medAtual","tinhaConcSalva","mesmoMedicamento","medData","concExtraida","concPadrao","buttonsContainer","conc","maskDecimal","int","dec","intFmt","maskTwoDecimals","format","digits","intPart","decPart","handler","parsePtBrNumber","str","submitBtn","originalText","resolve","peso","sens","calcular","renderResultado","raw","alert","alertMsg","msg","alertEl","isComprimido","regra","medNome","doseParsed","medLower","dosePadrao","doseMinMg","doseMaxMg","mgKg","doseMgNum","volumeMinMl","volumeMaxMl","volumeMlNum","comprimidosMin","comprimidosMax","comprimidos","faixaStr","alerta"],"mappings":"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"}